nameOverride: ""
namespaceOverride: ""
kubeTargetVersionOverride: ""
kubeVersionOverride: ""
fullnameOverride: ""
commonLabels: {}
defaultRules:
  create: true
  rules:
    alertmanager: true
    etcd: true
    configReloaders: true
    general: true
    k8s: true
    kubeApiserver: true
    kubeApiserverAvailability: true
    kubeApiserverSlos: true
    kubelet: true
    kubeProxy: true
    kubePrometheusGeneral: true
    kubePrometheusNodeRecording: true
    kubernetesApps: true
    kubernetesResources: true
    kubernetesStorage: true
    kubernetesSystem: true
    kubeScheduler: true
    kubeStateMetrics: true
    network: true
    node: true
    nodeExporterAlerting: true
    nodeExporterRecording: true
    prometheus: true
    prometheusOperator: true
  appNamespacesTarget: ".*"
  labels: {}
  annotations: {}
  additionalRuleLabels: {}
  runbookUrl: "https://runbooks.prometheus-operator.dev/runbooks"
  disabled: {}
additionalPrometheusRulesMap: {}
global:
  rbac:
    create: true
    createAggregateClusterRoles: false
    pspEnabled: false
    pspAnnotations: {}
  imagePullSecrets: []
alertmanager:
  enabled: true
  annotations: {}
  apiVersion: v2
  serviceAccount:
    create: true
    name: ""
    annotations: {}
  podDisruptionBudget:
    enabled: false
    minAvailable: 1
    maxUnavailable: ""
  config:
    global:
      resolve_timeout: 5m  # è§£å†³å‘Šè­¦çŠ¶æ€çš„è¶…æ—¶æ—¶é—´è®¾ç½®ä¸º 5 åˆ†é’Ÿï¼Œé€‚ç”¨äºè¾ƒå¿«é€Ÿæ¢å¤çš„å‘Šè­¦åœºæ™¯
      smtp_from: xiahediyijun@163.com  # å‘ä»¶äººé‚®ç®±åœ°å€
      smtp_smarthost: smtp.163.com:465  # é‚®ä»¶æœåŠ¡å™¨åœ°å€å’Œç«¯å£
      smtp_auth_username: xiahediyijun@163.com  # é‚®ç®±è®¤è¯ç”¨æˆ·å
      smtp_auth_password: 123456789 # é‚®ç®±è®¤è¯å¯†ç 
      smtp_require_tls: false  # å¯ç”¨ TLS å®‰å…¨ä¼ è¾“ï¼Œç¡®ä¿é‚®ä»¶çš„åŠ å¯†ä¼ è¾“å®‰å…¨
    route:
      group_by: ['alertname', 'namespace', 'instance', 'pod']  # æ ¹æ®å‘Šè­¦åç§°ã€å‘½åç©ºé—´ã€å®ä¾‹å’Œ pod è¿›è¡Œåˆ†ç»„ï¼Œé˜²æ­¢åˆ†æ•£è¿‡å¤šçš„é‡å¤å‘Šè­¦
      group_wait: 30s  # ç­‰å¾… 30 ç§’ä»¥ä¾¿å¯èƒ½ä¼šæœ‰æ›´å¤šçš„å‘Šè­¦åˆå¹¶
      group_interval: 5m  # å‘Šè­¦ç»„å‘é€é—´éš”ä¸º 5 åˆ†é’Ÿ
      repeat_interval: 1h # å‘Šè­¦æ¯ 1 å°æ—¶é‡å¤ä¸€æ¬¡
      receiver: critical-alerts  # é»˜è®¤å‘Šè­¦æ¥æ”¶å™¨ä¸º critical-alertsï¼Œå¤„ç†ä¸¥é‡å‘Šè­¦
      routes:
      - match:
          severity: critical  # åŒ¹é…ä¸¥é‡çº§åˆ« (critical) çš„å‘Šè­¦
        receiver: critical-alerts  # ä¸¥é‡å‘Šè­¦å‘é€åˆ° critical-alerts æ¥æ”¶å™¨
        group_interval: 5m  # ä¸¥é‡å‘Šè­¦æ¯ 5 åˆ†é’Ÿå¯ä»¥å‘é€ä¸€ç»„
        repeat_interval: 1h  # ä¸¥é‡å‘Šè­¦æ¯ 1 å°æ—¶é‡å¤æé†’ä¸€æ¬¡
      - match:
          severity: warning  # åŒ¹é…è­¦å‘Šçº§åˆ« (warning) çš„å‘Šè­¦
        receiver: warning-alerts  # è­¦å‘Šå‘Šè­¦å‘é€åˆ° warning-alerts æ¥æ”¶å™¨
        repeat_interval: 4h  # è­¦å‘Šå‘Šè­¦æ¯ 4 å°æ—¶é‡å¤æé†’ä¸€æ¬¡
      - match:
          severity: info  # åŒ¹é…ä¿¡æ¯çº§åˆ« (info) çš„å‘Šè­¦
        receiver: info-alerts  # ä¿¡æ¯å‘Šè­¦å‘é€åˆ° info-alerts æ¥æ”¶å™¨
        repeat_interval: 2h  # ä¿¡æ¯å‘Šè­¦æ¯ 2 å°æ—¶é‡å¤æé†’ä¸€æ¬¡
      ############################### Custom rules è‡ªå®šä¹‰å‘Šè­¦æ¨é€##################################
      #### æåŸ¹äº® å‘Šè­¦æ¨é€ ####
      - match:
          apps: app-pod
          severity: app-pod-critical  # åŒ¹é…çº§åˆ« (app-pod-critical) çš„å‘Šè­¦
        receiver: app-pod-alerts  # ä¸¥é‡å‘Šè­¦å‘é€åˆ° app-pod-alerts æ¥æ”¶å™¨
        group_interval: 5m  # ä¸¥é‡å‘Šè­¦æ¯ 5 åˆ†é’Ÿå¯ä»¥å‘é€ä¸€ç»„
        repeat_interval: 1h  # ä¸¥é‡å‘Šè­¦æ¯ 1 å°æ—¶é‡å¤æé†’ä¸€æ¬¡
    inhibit_rules:
      # å®šä¹‰å‘Šè­¦æŠ‘åˆ¶è§„åˆ™ï¼Œå½“è¾ƒé«˜ä¼˜å…ˆçº§çš„å‘Šè­¦å­˜åœ¨æ—¶æŠ‘åˆ¶è¾ƒä½ä¼˜å…ˆçº§çš„å‘Šè­¦
      - source_match:
          severity: 'critical'  # æ¥æºæ˜¯ä¸¥é‡çº§åˆ«çš„å‘Šè­¦
        target_match:
          severity: 'warning'  # ç›®æ ‡æ˜¯è­¦å‘Šçº§åˆ«çš„å‘Šè­¦
        equal: ['alertname', 'namespace', 'instance']  # å¦‚æœå‘Šè­¦åç§°ã€å‘½åç©ºé—´å’Œå®ä¾‹ç›¸åŒï¼Œåˆ™æŠ‘åˆ¶è­¦å‘Šçº§åˆ«çš„å‘Šè­¦
      - source_match:
          severity: 'warning'  # æ¥æºæ˜¯è­¦å‘Šçº§åˆ«çš„å‘Šè­¦
        target_match:
          severity: 'info'  # ç›®æ ‡æ˜¯ä¿¡æ¯çº§åˆ«çš„å‘Šè­¦
        equal: ['alertname', 'namespace', 'instance']  # å¦‚æœå‘Šè­¦åç§°ã€å‘½åç©ºé—´å’Œå®ä¾‹ç›¸åŒï¼Œåˆ™æŠ‘åˆ¶ä¿¡æ¯çº§åˆ«çš„å‘Šè­¦
    receivers:
      - name: critical-alerts
        webhook_configs:
          - url: http://webhook-service:8080/prometheusalert?type=fs&tpl=prometheus-fs&fsurl=https://open.feishu.cn/open-apis/bot/v2/hook/xxxxxxxxxxxxxxxxxxxxxxxxxxx
        email_configs:
          - to: '{{ template "email.to" }}'  # æ”¶ä»¶äººé‚®ç®±åœ°å€2099637909@qq.comï¼Œæ›¿æ¢ä¸ºæ‚¨çš„å®é™…é‚®ç®±æˆ–è€…(ä»å‘Šè­¦æ¨¡ç‰ˆçš„å˜é‡ä¸­è·å–) '{{ template "email.to" }}'
            headers: { Subject: "[ä¸¥é‡å‘Šè­¦-æµ‹è¯•ç¯å¢ƒ] " }  # å‘Šè­¦ä¸»é¢˜æˆ–è¿™(ä»å‘Šè­¦æ¨¡ç‰ˆçš„å˜é‡ä¸­è·å–) {{ define "email.title" }}æµ‹è¯•ç¯å¢ƒå‘Šè­¦{{ end }}
            html: '{{ template "email.to.html" .}}'  # é‚®ç®±å†…å®¹(ä»å‘Šè­¦æ¨¡ç‰ˆçš„å˜é‡ä¸­è·å–)
            send_resolved: true  # å‘é€å‘Šè­¦æ¢å¤é€šçŸ¥
      - name: warning-alerts
        webhook_configs:
          - url: http://webhook-service:8080/prometheusalert?type=fs&tpl=prometheus-fs&fsurl=https://open.feishu.cn/open-apis/bot/v2/hook/xxxxxxxxxxxxxxxxxxxxxxxxxxxx
        email_configs:
          - to: '{{ template "email.to" }}'  # æ”¶ä»¶äººé‚®ç®±åœ°å€2099637909@qq.comï¼Œæ›¿æ¢ä¸ºæ‚¨çš„å®é™…é‚®ç®±æˆ–è€…(ä»å‘Šè­¦æ¨¡ç‰ˆçš„å˜é‡ä¸­è·å–) '{{ template "email.to" }}'
            headers: { Subject: "[è­¦å‘Šå‘Šè­¦-æµ‹è¯•ç¯å¢ƒ] " }  # å‘Šè­¦ä¸»é¢˜æˆ–è¿™(ä»å‘Šè­¦æ¨¡ç‰ˆçš„å˜é‡ä¸­è·å–) {{ define "email.title" }}æµ‹è¯•ç¯å¢ƒå‘Šè­¦{{ end }}
            html: '{{ template "email.to.html" .}}'  # é‚®ç®±å†…å®¹(ä»å‘Šè­¦æ¨¡ç‰ˆçš„å˜é‡ä¸­è·å–)
            send_resolved: true  # å‘é€å‘Šè­¦æ¢å¤é€šçŸ¥
      - name: info-alerts
        webhook_configs:
          - url: http://webhook-service:8080/prometheusalert?type=fs&tpl=prometheus-fs&fsurl=https://open.feishu.cn/open-apis/bot/v2/hook/xxxxxxxxxxxxxxxxxxxxxxxxxxx
        email_configs:
          - to: '{{ template "email.to" }}'  # æ”¶ä»¶äººé‚®ç®±åœ°å€2099637909@qq.comï¼Œæ›¿æ¢ä¸ºæ‚¨çš„å®é™…é‚®ç®±æˆ–è€…(ä»å‘Šè­¦æ¨¡ç‰ˆçš„å˜é‡ä¸­è·å–) '{{ template "email.to" }}'
            headers: { Subject: "[æ­£å¸¸å‘Šè­¦-æµ‹è¯•ç¯å¢ƒ] " }  # å‘Šè­¦ä¸»é¢˜æˆ–è¿™(ä»å‘Šè­¦æ¨¡ç‰ˆçš„å˜é‡ä¸­è·å–) {{ define "email.title" }}æµ‹è¯•ç¯å¢ƒå‘Šè­¦{{ end }}
            html: '{{ template "email.to.html" .}}'  # é‚®ç®±å†…å®¹(ä»å‘Šè­¦æ¨¡ç‰ˆçš„å˜é‡ä¸­è·å–)
            send_resolved: true  # å‘é€å‘Šè­¦æ¢å¤é€šçŸ¥
      - name: app-pod-alerts  # è‡ªå®šä¹‰å‘Šè­¦æ¨é€æ¥æ”¶å™¨
        webhook_configs:
          - url: http://webhook-service:8080/prometheusalert?type=fs&tpl=prometheus-fs&fsurl=https://open.feishu.cn/open-apis/bot/v2/hook/xxxxxxxxxxxxxxxxxxxxxxxxxxx
    templates:
      - '/etc/alertmanager/config/*.tmpl'

  tplConfig: false
  templateFiles:
    email.tmpl: |-
      {{ define "email.to" }}2099637909@qq.com{{ end }}
      {{ define "email.to.html" }}
      {{ range .Alerts }}
      <p>==========<strong>å‘Šè­¦é€šçŸ¥ ğŸš¨</strong>==========</p>
      <strong>â° è§¦å‘æ—¶é—´:</strong> {{ (.StartsAt.Add 28800e9).Format "2006-01-02 15:04:05" }}<br>
      <strong>ğŸ”§ å‘Šè­¦ç¨‹åº:</strong> prometheus_alert<br>
      <strong>âš ï¸ å‘Šè­¦çº§åˆ«:</strong> {{ .Labels.severity }}<br>
      <strong>ğŸ“Š å‘Šè­¦ç±»å‹:</strong> {{ .Labels.alertname }}<br>
      <strong>ğŸ“ å‘Šè­¦ä¿¡æ¯:</strong> {{ .Annotations.summary }}<br>
      <strong>ğŸ“ƒ å‘Šè­¦æè¿°:</strong> {{ .Annotations.description }}<br>
      <strong>ğŸš¦ å½“å‰çŠ¶æ€:</strong> {{ .Status }}<br>
      <strong>ğŸ“ å®ä¾‹é¡¹ç›®:</strong> {{ .Labels.namespace}}<br>
      <strong>ğŸ·ï¸ å®ä¾‹åç§°:</strong> {{ .Labels.pod }}<br>
      <strong>ğŸ” å®ä¾‹ç±»å‹:</strong> {{ .Labels.instance_type }}<br>
      <strong>ğŸ’» å®ä¾‹ IP:</strong> {{ .Labels.pod_ip }}<br>
      <strong>ğŸ–¥ï¸ èŠ‚ç‚¹åç§°:</strong> {{ .Labels.node }}<br>
      <strong>ğŸŒ èŠ‚ç‚¹ IP:</strong> {{ .Labels.node_ip }}<br>
      <strong>Prometheusç›‘æ§ç•Œé¢åœ°å€:</strong> <a href="{{ .GeneratorURL }}">ç‚¹å‡»è·³è½¬</a><br>
      
      {{ if eq .Status "resolved" }}
      <p>==========<strong>å‘Šè­¦æ¢å¤é€šçŸ¥ âœ…</strong>==========</p>
      <strong>ğŸ•’ æ¢å¤æ—¶é—´:</strong> {{ if .EndsAt }}{{ (.EndsAt.Add 28800e9).Format "2006-01-02 15:04:05" }}{{ else }}N/A{{ end }}<br>
      <strong>ğŸ”§ å‘Šè­¦ç¨‹åº:</strong> prometheus_alert<br>
      <strong>âš ï¸ å‘Šè­¦çº§åˆ«:</strong> {{ .Labels.severity }}<br>
      <strong>ğŸ“Š å‘Šè­¦ç±»å‹:</strong> {{ .Labels.alertname }}<br>
      <strong>ğŸ“ å‘Šè­¦ä¿¡æ¯:</strong> {{ .Annotations.summary }}<br>
      <strong>ğŸ“ƒ å‘Šè­¦æè¿°:</strong> {{ .Annotations.description }}<br>
      <strong>ğŸš¦ å½“å‰çŠ¶æ€:</strong> {{ .Status }}<br>
      <strong>ğŸ“ å®ä¾‹é¡¹ç›®:</strong> {{ .Labels.namespace}}<br>
      <strong>ğŸ·ï¸ å®ä¾‹åç§°:</strong> {{ .Labels.pod }}<br>
      <strong>ğŸ” å®ä¾‹ç±»å‹:</strong> {{ .Labels.instance_type }}<br>
      <strong>ğŸ’» å®ä¾‹ IP:</strong> {{ .Labels.pod_ip }}<br>
      <strong>ğŸ–¥ï¸ èŠ‚ç‚¹åç§°:</strong> {{ .Labels.node }}<br>
      <strong>ğŸŒ èŠ‚ç‚¹ IP:</strong> {{ .Labels.node_ip }}<br>
      {{ end }} <!-- ç»“æŸæ¢å¤å‘Šè­¦çš„æ¡ä»¶ -->
      {{ end }} <!-- ç»“æŸå‘Šè­¦å¾ªç¯ -->
      {{ end }} <!-- ç»“æŸæ¨¡æ¿å®šä¹‰ -->
  ingress:
    enabled: true
    ingressClassName: nginx
    hosts:
    - alertmanager.demo.com
    paths:
    - /
  secret:
    annotations: {}
  ingressPerReplica:
    enabled: false
    annotations: {}
    labels: {}
    hostPrefix: ""
    hostDomain: ""
    paths: []
    tlsSecretName: ""
    tlsSecretPerReplica:
      enabled: false
      prefix: "alertmanager"
  service:
    annotations: {}
    labels: {}
    clusterIP: ""
    port: 9093
    targetPort: 9093
    nodePort: 32093
    additionalPorts: []
    externalIPs: []
    loadBalancerIP: ""
    loadBalancerSourceRanges: []
    externalTrafficPolicy: Cluster
    type: NodePort
  servicePerReplica:
    enabled: false
    annotations: {}
    port: 9093
    targetPort: 9093
    nodePort: 30904
    loadBalancerSourceRanges: []
    externalTrafficPolicy: Cluster
    type: ClusterIP
  serviceMonitor:
    interval: ""
    selfMonitor: true
    proxyUrl: ""
    scheme: ""
    tlsConfig: {}
    bearerTokenFile:
    metricRelabelings: []
    relabelings: []
  alertmanagerSpec:
    podMetadata: {}
    image:
      repository: quay.io/prometheus/alertmanager
      tag: v0.24.0
      sha: ""
    useExistingSecret: false
    secrets: []
    configMaps: []
    alertmanagerConfigSelector: {}
    alertmanagerConfigNamespaceSelector: {}
    alertmanagerConfiguration: {}
    logFormat: logfmt
    logLevel: info
    replicas: 2
    retention: 120h
    storage:
      volumeClaimTemplate:
        spec:
          storageClassName: nas-nfs-provider
          accessModes: ["ReadWriteOnce"]
          resources:
            requests:
              storage: 1Ti
    # å‘Šè­¦é¡µé¢URL;é»˜è®¤ä¸º ingress è¯·æ±‚ hosts,å¦‚æœä½¿ç”¨ nodeport å¯ä»¥æ˜¯è®¾ç½®ä¸º ip + ç«¯å£
    externalUrl:
    routePrefix: /
    paused: false
    nodeSelector: {}
    resources:
      requests:
        memory: "512Mi"  # alertmanagerå¯åŠ¨æ—¶æ‰€éœ€çš„æœ€å°å†…å­˜
        cpu: "200m"      # alertmanagerå¯åŠ¨æ—¶æ‰€éœ€çš„æœ€å°å†…å­˜å¯åŠ¨æ—¶æ‰€éœ€çš„æœ€å°CPU
      limits:
        memory: "4Gi"  # alertmanagerå¯åŠ¨æ—¶æ‰€éœ€çš„æœ€å°å†…å­˜å¯ä»¥ä½¿ç”¨çš„æœ€å¤§å†…å­˜
        cpu: "4"      # alertmanagerå¯åŠ¨æ—¶æ‰€éœ€çš„æœ€å°å†…å­˜å¯ä»¥ä½¿ç”¨çš„æœ€å¤§CPU
    podAntiAffinity: ""
    podAntiAffinityTopologyKey: kubernetes.io/hostname
    affinity: {}
    tolerations: []
    topologySpreadConstraints: []
    securityContext:
      runAsGroup: 2000
      runAsNonRoot: true
      runAsUser: 1000
      fsGroup: 2000
    listenLocal: false
    containers: []
    volumes: []
     # - name: alertmanager-template
     #   configMap:
     #     name: alertmanager-template  # ConfigMap åç§°è¦å’Œä¸Šé¢ä¿æŒä¸€è‡´
    volumeMounts: []
     # - name: alertmanager-template
     #   mountPath: /etc/alertmanager/template    # ä½ æƒ³è¦æŒ‚è½½åˆ°çš„è·¯å¾„
     #   readOnly: true
    initContainers: []
    priorityClassName: ""
    additionalPeers: []
    portName: "http-web"
    clusterAdvertiseAddress: false
    forceEnableClusterMode: false
  extraSecret:
    annotations: {}
    data: {}
grafana:
  enabled: true
  namespaceOverride: ""
  forceDeployDatasources: false
  forceDeployDashboards: false
  defaultDashboardsEnabled: true
  defaultDashboardsTimezone: utc
  adminPassword: prom-operator
  rbac:
    pspEnabled: false
  ingress:
    enabled: true
    ingressClassName: nginx
    hosts:
    - grafana.demo.com
    path: /
    tls: []
  sidecar:
    dashboards:
      enabled: true
      label: grafana_dashboard
      labelValue: "1"
      annotations: {}
      multicluster:
        global:
          enabled: false
        etcd:
          enabled: false
      provider:
        allowUiUpdates: false
    datasources:
      enabled: true
      defaultDatasourceEnabled: true
      uid: prometheus
      annotations: {}
      createPrometheusReplicasDatasources: false
      label: grafana_datasource
      labelValue: "1"
  extraConfigmapMounts: []
  deleteDatasources: []
  additionalDataSources: []
  service:
    portName: http-web
  serviceMonitor:
    enabled: true
    path: "/metrics"
    labels:
      release: kube-prometheus-stack
    interval: ""
    scheme: http
    tlsConfig: {}
    scrapeTimeout: 30s
    relabelings: []
  # æ·»åŠ çš„ PVC æŒä¹…åŒ–å­˜å‚¨å·é…ç½®
  persistence:
    enabled: true
    type: pvc
    accessModes:
      - ReadWriteOnce
    size: 300Gi  # å¯ä»¥æ ¹æ®éœ€æ±‚è°ƒæ•´å­˜å‚¨å¤§å°
    storageClassName: nas-nfs-provider
    finalizers:
      - kubernetes.io/pvc-protection
  # æ·»åŠ èµ„æºè¯·æ±‚å’Œé™åˆ¶é…ç½®
  resources:
    requests:
      memory: "500Mi"  # Grafanaå¯åŠ¨æ—¶æ‰€éœ€çš„æœ€å°å†…å­˜
      cpu: "500m"      # Grafanaå¯åŠ¨æ—¶æ‰€éœ€çš„æœ€å°CPU
    limits:
      memory: "1Gi"  # Grafanaå¯ä»¥ä½¿ç”¨çš„æœ€å¤§å†…å­˜
      cpu: "800m"      # Grafanaå¯ä»¥ä½¿ç”¨çš„æœ€å¤§CPU
kubeApiServer:
  enabled: true
  tlsConfig:
    serverName: kubernetes
    insecureSkipVerify: false
  serviceMonitor:
    interval: ""
    proxyUrl: ""
    jobLabel: component
    selector:
      matchLabels:
        component: apiserver
        provider: kubernetes
    metricRelabelings: []
    relabelings: []
kubelet:
  enabled: true
  namespace: kube-system
  serviceMonitor:
    interval: ""
    proxyUrl: ""
    https: true
    cAdvisor: true
    probes: true
    resource: false
    resourcePath: "/metrics/resource/v1alpha1"
    cAdvisorMetricRelabelings: []
    probesMetricRelabelings: []
    cAdvisorRelabelings:
      - sourceLabels: [__metrics_path__]
        targetLabel: metrics_path
    probesRelabelings:
      - sourceLabels: [__metrics_path__]
        targetLabel: metrics_path
    resourceRelabelings:
      - sourceLabels: [__metrics_path__]
        targetLabel: metrics_path
    metricRelabelings: []
    relabelings:
      - sourceLabels: [__metrics_path__]
        targetLabel: metrics_path
kubeControllerManager:
  enabled: true
  endpoints: []
  service:
    enabled: true
    port: 10257
    targetPort: 10257
  serviceMonitor:
    enabled: true
    interval: ""
    proxyUrl: ""
    https: true
    insecureSkipVerify: true
    serverName: null
    metricRelabelings: []
    relabelings: []
coreDns:
  enabled: true
  service:
    port: 9153
    targetPort: 9153
  serviceMonitor:
    interval: ""
    proxyUrl: ""
    metricRelabelings: []
    relabelings: []
kubeDns:
  enabled: true
  service:
    dnsmasq:
      port: 10054
      targetPort: 9153
    skydns:
      port: 10055
      targetPort: 9153
  serviceMonitor:
    interval: ""
    proxyUrl: ""
    metricRelabelings: []
    relabelings: []
    dnsmasqMetricRelabelings: []
    dnsmasqRelabelings: []
kubeEtcd:
  enabled: true
  endpoints:
  - 172.16.246.102      #å¤–éƒ¨etcdçš„IPåœ°å€
  - 172.16.246.103      #å¤–éƒ¨etcdçš„IPåœ°å€
  - 172.16.246.104      #å¤–éƒ¨etcdçš„IPåœ°å€
  service:
    enabled: true
    port: 2379
    targetPort: 2379
  serviceMonitor:
    enabled: true
    interval: ""
    proxyUrl: ""
    scheme: https            #ä½¿ç”¨httpsåè®®
    insecureSkipVerify: true      #ä¸å¯¹è¯ä¹¦è¿›è¡ŒéªŒè¯
    serverName: "localhost"
    #caFile: "/etc/etcd/ssl/ca.pem"
    #certFile: "/etc/etcd/ssl/server.pem"
    #keyFile: "/etc/etcd/ssl/server-key.pem"
    caFile: "/etc/prometheus/secrets/kube-etcd-client-certs/etcd-client-ca.crt"
    certFile: "/etc/prometheus/secrets/kube-etcd-client-certs/etcd-client.crt"
    keyFile: "/etc/prometheus/secrets/kube-etcd-client-certs/etcd-client.key"
kubeScheduler:
  enabled: true
  endpoints: []
  service:
    enabled: true
    port: 10259
    targetPort: 10259
  serviceMonitor:
    enabled: true
    interval: ""
    proxyUrl: ""
    https: true
    insecureSkipVerify: true
    serverName: null
    metricRelabelings: []
    relabelings: []
kubeProxy:
  enabled: true
  endpoints: []
  service:
    enabled: true
    port: 10249
    targetPort: 10249
  serviceMonitor:
    enabled: true
    interval: ""
    proxyUrl: ""
    https: false
    metricRelabelings: []
    relabelings: []
kubeStateMetrics:
  enabled: true
kube-state-metrics:
  namespaceOverride: ""
  rbac:
    create: true
  releaseLabel: true
  prometheus:
    monitor:
      enabled: true
      interval: ""
      scrapeTimeout: ""
      proxyUrl: ""
      honorLabels: true
      metricRelabelings: []
      relabelings: []
  selfMonitor:
    enabled: false
nodeExporter:
  enabled: true
prometheus-node-exporter:
  namespaceOverride: ""
  podLabels:
    jobLabel: node-exporter
  extraArgs:
    - --collector.filesystem.mount-points-exclude=^/(dev|proc|sys|var/lib/docker/.+|var/lib/kubelet/.+)($|/)
    - --collector.filesystem.fs-types-exclude=^(autofs|binfmt_misc|bpf|cgroup2?|configfs|debugfs|devpts|devtmpfs|fusectl|hugetlbfs|iso9660|mqueue|nsfs|overlay|proc|procfs|pstore|rpc_pipefs|securityfs|selinuxfs|squashfs|sysfs|tracefs)$
  service:
    portName: http-metrics
  prometheus:
    monitor:
      enabled: true
      jobLabel: jobLabel
      interval: ""
      scrapeTimeout: ""
      proxyUrl: ""
      metricRelabelings: []
      relabelings: []
  rbac:
    pspEnabled: false
prometheusOperator:
  enabled: true
  tls:
    enabled: true
    tlsMinVersion: VersionTLS13
    internalPort: 10250
  admissionWebhooks:
    failurePolicy: Fail
    enabled: true
    caBundle: ""
    patch:
      enabled: true
      image:
        repository: registry.cn-hangzhou.aliyuncs.com/tianxiang_app/ingress-nginx-kube-webhook-certgen
        tag: v1.1.1
        sha: ""
        pullPolicy: IfNotPresent
      resources: {}
      priorityClassName: ""
      podAnnotations: {}
      nodeSelector: {}
      affinity: {}
      tolerations: []
      securityContext:
        runAsGroup: 2000
        runAsNonRoot: true
        runAsUser: 2000
    certManager:
      enabled: false
      rootCert:
        duration: ""  # default to be 5y
      admissionCert:
        duration: ""  # default to be 1y
  namespaces: {}
  denyNamespaces: []
  alertmanagerInstanceNamespaces: []
  prometheusInstanceNamespaces: []
  thanosRulerInstanceNamespaces: []
  serviceAccount:
    create: true
    name: ""
  service:
    annotations: {}
    labels: {}
    clusterIP: ""
    nodePort: 30080
    nodePortTls: 30443
    additionalPorts: []
    loadBalancerIP: ""
    loadBalancerSourceRanges: []
    externalTrafficPolicy: Cluster
    type: ClusterIP
    externalIPs: []
  podLabels: {}
  podAnnotations: {}
  kubeletService:
    enabled: true
    namespace: kube-system
    name: ""
  serviceMonitor:
    interval: ""
    scrapeTimeout: ""
    selfMonitor: true
    metricRelabelings: []
    relabelings: []
  resources:
    limits:
      cpu: 200m
      memory: 200Mi
    requests:
      cpu: 100m
      memory: 100Mi
  hostNetwork: false
  nodeSelector: {}
  tolerations: []
  affinity: {}
  dnsConfig: {}
  securityContext:
    fsGroup: 65534
    runAsGroup: 65534
    runAsNonRoot: true
    runAsUser: 65534
  containerSecurityContext:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: true
  image:
    repository: quay.io/prometheus-operator/prometheus-operator
    tag: v0.56.0
    sha: ""
    pullPolicy: IfNotPresent
  prometheusConfigReloader:
    image:
      repository: quay.io/prometheus-operator/prometheus-config-reloader
      tag: v0.56.0
      sha: ""
    resources:
      requests:
        cpu: 200m
        memory: 50Mi
      limits:
        cpu: 200m
        memory: 50Mi
  thanosImage:
    repository: quay.io/thanos/thanos
    tag: v0.25.2
    sha: ""
  secretFieldSelector: ""
prometheus:
  enabled: true
  annotations: {}
  serviceAccount:
    create: true
    name: ""
    annotations: {}
  thanosService:
    enabled: false
    annotations: {}
    labels: {}
    externalTrafficPolicy: Cluster
    type: ClusterIP
    portName: grpc
    port: 10901
    targetPort: "grpc"
    httpPortName: http
    httpPort: 10902
    targetHttpPort: "http"
    clusterIP: "None"
    nodePort: 30901
    httpNodePort: 30902
  thanosServiceMonitor:
    enabled: false
    interval: ""
    scheme: ""
    tlsConfig: {}
    bearerTokenFile:
    metricRelabelings: []
    relabelings: []
  thanosServiceExternal:
    enabled: false
    annotations: {}
    labels: {}
    loadBalancerIP: ""
    loadBalancerSourceRanges: []
    portName: grpc
    port: 10901
    targetPort: "grpc"
    httpPortName: http
    httpPort: 10902
    targetHttpPort: "http"
    externalTrafficPolicy: Cluster
    type: LoadBalancer
    nodePort: 30901
    httpNodePort: 30902
  service:
    annotations: {}
    labels: {}
    clusterIP: ""
    port: 9090
    targetPort: 9090
    externalIPs: []
    nodePort: 32090
    loadBalancerIP: ""
    loadBalancerSourceRanges: []
    externalTrafficPolicy: Cluster
    type: NodePort
    additionalPorts: []
    publishNotReadyAddresses: false
    sessionAffinity: ""
  servicePerReplica:
    enabled: false
    annotations: {}
    port: 9090
    targetPort: 9090
    nodePort: 30091
    loadBalancerSourceRanges: []
    externalTrafficPolicy: Cluster
    type: ClusterIP
  podDisruptionBudget:
    enabled: false
    minAvailable: 1
    maxUnavailable: ""
  thanosIngress:
    enabled: false
    annotations: {}
    labels: {}
    servicePort: 10901
    nodePort: 30901
    hosts: []
    paths: []
    tls: []
  extraSecret:
    annotations: {}
    data: {}
  ingress:
    enabled: true
    ingressClassName: nginx
    hosts:
    - prometheus.demo.com
    paths:
    - /
  ingressPerReplica:
    enabled: false
    annotations: {}
    labels: {}
    hostPrefix: ""
    hostDomain: ""
    paths: []
    tlsSecretName: ""
    tlsSecretPerReplica:
      enabled: false
      prefix: "prometheus"
  podSecurityPolicy:
    allowedCapabilities: []
    allowedHostPaths: []
    volumes: []
  serviceMonitor:
    interval: ""
    selfMonitor: true
    scheme: ""
    tlsConfig: {}
    bearerTokenFile:
    metricRelabelings: []
    relabelings: []
  prometheusSpec:
    disableCompaction: false
    apiserverConfig: {}
    scrapeInterval: ""
    scrapeTimeout: ""
    evaluationInterval: ""
    listenLocal: false
    enableAdminAPI: false
    web: {}
    enableFeatures: []
    image:
      repository: quay.io/prometheus/prometheus
      tag: v2.35.0
      sha: ""
    # æ±¡ç‚¹å®¹å¿
    tolerations: []
    topologySpreadConstraints: []
    alertingEndpoints: []
    externalLabels: {}
    replicaExternalLabelName: ""
    replicaExternalLabelNameClear: false
    prometheusExternalLabelName: ""
    prometheusExternalLabelNameClear: false
    # å‘Šè­¦é¡µé¢URL;é»˜è®¤ä¸º ingress è¯·æ±‚ hosts,å¦‚æœä½¿ç”¨ nodeport å¯ä»¥æ˜¯è®¾ç½®ä¸º ip + ç«¯å£
    externalUrl: ""
    # å¯ä»¥é€‰æ‹©æ€§çš„å°† Prometheus éƒ¨ç½²åˆ°ä¸€å°ç‰¹æ®Šçš„æœåŠ¡å™¨ä¸Š
    nodeSelector: {}
    # åˆ›å»ºçš„ etcd è¯ä¹¦
    secrets:
    - kube-etcd-client-certs
    configMaps: []
    query: {}
    ruleNamespaceSelector: {}
    ruleSelectorNilUsesHelmValues: true
    ruleSelector: {}
    serviceMonitorSelectorNilUsesHelmValues: true
    serviceMonitorSelector: {}
    serviceMonitorNamespaceSelector: {}
    podMonitorSelectorNilUsesHelmValues: true
    podMonitorSelector: {}
    podMonitorNamespaceSelector: {}
    probeSelectorNilUsesHelmValues: true
    probeSelector: {}
    probeNamespaceSelector: {}
    retention: 10d
    retentionSize: ""
    walCompression: false
    paused: false
    replicas: 3
    shards: 1
    logLevel: info
    logFormat: logfmt
    routePrefix: /
    podMetadata: {}
    podAntiAffinity: ""
    podAntiAffinityTopologyKey: kubernetes.io/hostname
    affinity: {}
   # affinity:
   #   nodeAffinity:
   #     requiredDuringSchedulingIgnoredDuringExecution:
   #       nodeSelectorTerms:    # æ ‡è¯†è°ƒåº¦åˆ° k8s-app=prometheus çš„ node èŠ‚ç‚¹ä¸Š
   #         - matchExpressions:
   #             - key: k8s-app  # node æ ‡ç­¾ key
   #               operator: In
   #               values:
   #                 - prometheus  # node æ ‡ç­¾ value
    remoteRead: []
    additionalRemoteRead: []
    remoteWrite: []
    additionalRemoteWrite: []
    remoteWriteDashboards: false
    # èµ„æºè¯·æ±‚é™åˆ¶è¦æ ¹æ®å®é™…æƒ…å†µæ¥å®šï¼Œä¸ç„¶å¾ˆå®¹æ˜“å°±oomkilledï¼Œå¦‚æœé›†ç¾¤åºå¤§ï¼ŒèŠ‚ç‚¹ä¼—å¤šï¼ŒæŒ‡æ ‡ä¹Ÿå°±ä¼šå¤šï¼ŒPrometheusé‡‡é›†çš„æ—¶å€™ä¼šæ¶ˆè€—å·¨å¤§çš„å†…å­˜
    resources:
      limits:
        cpu: "4"
        memory: "16Gi"
      requests:
        cpu: "2"
        memory: "8Gi"
    storageSpec:
      volumeClaimTemplate:
        spec:
          storageClassName: nas-nfs-provider
          accessModes: ["ReadWriteOnce"]
          resources:
            requests:
              storage: 1Ti
    volumes: []
    volumeMounts: []
    additionalScrapeConfigs: []
    additionalScrapeConfigsSecret: {}
    additionalPrometheusSecretsAnnotations: {}
    additionalAlertManagerConfigs: []
    additionalAlertManagerConfigsSecret: {}
    additionalAlertRelabelConfigs: []
    additionalAlertRelabelConfigsSecret: {}
    securityContext:
      runAsGroup: 2000
      runAsNonRoot: true
      runAsUser: 1000
      fsGroup: 2000
    priorityClassName: ""
    thanos: {}
    containers: []
    initContainers: []
    portName: "http-web"
    arbitraryFSAccessThroughSMs: false
    overrideHonorLabels: false
    overrideHonorTimestamps: false
    ignoreNamespaceSelectors: false
    enforcedNamespaceLabel: ""
    prometheusRulesExcludedFromEnforce: []
    queryLogFile: false
    enforcedSampleLimit: false
    enforcedTargetLimit: false
    enforcedLabelLimit: false
    enforcedLabelNameLengthLimit: false
    enforcedLabelValueLengthLimit: false
    allowOverlappingBlocks: false
  additionalRulesForClusterRole: []
  additionalServiceMonitors: []
  additionalPodMonitors: []
